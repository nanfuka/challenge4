<html>

<head>
    <title>
        Epic-mail
    </title>
    <link rel="stylesheet" href="../css/site.css">
    <!-- <script src="../js/get_recieved.js"></script> -->
</head>

<body onload="myFunctiona()">
    <div class="nav1">
        <a href="../index.html">Home</a>
        <a href="signin.html">Logout</a>
        <a href="signin.html">Login</a>
    </div>
    <div class="navrow">
        <div class="navbuttons">
            <a href="sent.html">sent</a>
            <a href="user_dash.html" class="active-page">inbox</a>
            <a href="compose.html">compose</a>
            <a href="admin.html">create a group</a>
            <a href="view_groups.html">view all groups created</a>

        </div>
        <div class="row3" id="row3">
                <p id = "negative"></p>
            <h2>REGISTER YOUR GROUP</h2>
            <div class="compose-row22">
           
                <input type="text" id="email" placeholder=" Enter user email">

            </div>
            <div class="compose-row33">
                    

                <input type="text" id="role" placeholder="Enter role"><br>

                <button class="myButto" id="creategroup">submit</button>
                </form>
                <div id="response"></div>

            </div>
        </div>
    </div>

    <div class="fuuter">
        <div class="footer1">
            <ul>
                <li><b>Our Partners</b></li>
                <li>Andela Uganda</li>
                <li>Andela Nigeria</li>
            </ul>
        </div>



        <div class="footer3">
            <p><b>Copyright 2019</b></p>
        </div>



        <div class="footer2">
            <ul>
                <li><b>Contact Us</b></li>
                <li>Website: www.epic.com</li>
                <li>Email: user@epic.com</li>
                <li>Tel: +07445478554</li>
            </ul>
        </div>
    </div>
</body>
<!-- <script src="../js/creategroup.js"></script> -->
<script>
    window.onload = function myFunctiona() {
        let current_url = location.href
        let url = new URL(current_url)
        let id = url.searchParams.get('idi')
        console.log(id)
        localStorage.setItem('identity', id)
        // readMessage(message_id)
        // r = document.getElementById('receiver-addr')
    }

    document.getElementById('creategroup').addEventListener('click', Compose);
    id = localStorage.getItem('identity');
    const adduser = `http://127.0.0.1:5000/api/v2/groups/${id}/users`;

    function Compose(e) {
        e.preventDefault();
        token = localStorage.getItem('token');
        if (token === null) {
            alert('You must log in');

        };


        let email = document.getElementById('email').value;
        let userrole = document.getElementById('role').value;

        let data = {
           email: email,
           userrole: userrole,

        }


        fetch(adduser, {
                method: 'POST',
                // mode: 'cors',
                headers: {
                    'Authorization': `Bearer ${token}`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            })
            .then(res => res.json())
            .then(response => {
                console.log(response);
                if (response.error === "Expired token. Please Log In again.") {

                }
                if (response.status === 200) {
                    console.log(response)
                    // document.getElementById("negative").innerHTML =
                    //     `<p style="background-color:green; width: 60%; margin-left: 20%;">message sent</p>`;
                } else {
                    document.getElementById("negative").innerHTML =
                        `<p style="background-color:red; width: 60%; margin-left: 20%;">${response.error}</p>`
                }
            })
            .catch(err => console.log(err));
    }
</script>

</html>
<!-- <html>

<head>
    <title>
        Epic-mail
    </title>
    <link rel="stylesheet" href="../css/styl.css">
    <script src="../js/add_grpmembers.js"></script>
</head>

<body onload="myFunction()">
    <div class="nav1">
        <a href="../index.html">Home</a>
        <a href="signin.html">Logout</a>
        <a href="signin.html">Login</a>
    </div>


    <form class="grp_register">
        <h2>ADD NEW MEMBER TO GROUP</h2>
        <div class="compose-row22">
            <p>Group name: <input type="text" id="name"></p>

            <div class="compose-row22">
                <p>New Members' name: <input type="text" id="name"></p>
                <div class="compose-row22">
                    <p>Members role: <input type="text" id="name"></p>
                </div>


                <button class="myButton" id="group_members">submit</button>
    </form>
    <div id="response"></div>
    <script src="../js/creategroup.js"></script>



    <footer>
        <div class="footer1">
            <ul>
                <li><b>Our Partners</b></li>
                <li>Andela Uganda</li>
                <li>Andela Nigeria</li>
            </ul>
        </div>



        <div class="footer3">
            <p><b>Copyright 2019</b></p>
        </div>



        <div class="footer2">
            <ul>
                <li><b>Contact Us</b></li>
                <li>Website: www.epic.com</li>
                <li>Email: user@epic.com</li>
                <li>Tel: +07445478554</li>
            </ul>
        </div>

    </footer>
</body> -->